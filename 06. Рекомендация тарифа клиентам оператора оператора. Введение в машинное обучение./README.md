# Исследование поведения клиентов оператора

Заказчик - федеральный оператор мобильной связи «Мегалайн». Клиентам предлагают два тарифных плана: «Смарт» и «Ультра». «Мегалайн» выяснил: многие клиенты пользуются архивными тарифами. Они хотят построить систему, способную проанализировать поведение клиентов и предложить пользователям новый тариф: «Смарт» или «Ультра».

Даны данные о поведении клиентов, которые уже перешли на эти тарифы. Предобработка данных проведена на предыдущем этапе.

Нужно построить модель для задачи классификации, которая выберет подходящий тариф для каждого из клиентов. Ключевая метрика качества работы модели - accuracy. Целевое значение accuracy - 0,75.

__Описание данных:__


- `сalls` — количество звонков;
- `minutes` — суммарная длительность звонков в минутах;
- `messages` — количество sms-сообщений;
- `mb_used` — израсходованный интернет-трафик в Мб;
- `is_ultra` — каким тарифом пользовался в течение месяца («Ультра» — 1, «Смарт» — 0).


__Цель исследования:__ Построить модель для задачи классификации клиентов по тарифам, с наилучшим показателем точности.


__Ход исследования:__
 1. Обзор данных. Вывод: В датасете 3214 наблюдений и 4 переменных. Целевой признак - подходящий абоненту тариф. Как видно из среднего числа целевого признака - среди абонентов 30,7% - пользователи тарифа "Ультра", 69,3% - пользователи тарифа "Смарт".
 2. Подготовка данных к обучению моделей.
 3. Обучение моделей.

    В рамках исследования были построены четыре основных модели классификации и оптимизированы их гиперпараметры:

    1. Логистическая регрессия.
    2. Дерево решений.
    3. Случайный лес.
    4. Метод ближайших соседей.
    5. Дамми модель для сравнения


 4. Оценка качества моделей.

    Все модели показали лучший результат, чем сравнительная модель Dummy. Она выбирала класс в соответствии с распределением исходных классов в тренировочной выборке. Этот результат чуть выше, чем у полностью случайного назначения, которое вероятнее всего показало бы результат близкий к 0,5.

    Лучший результат среди полноценных моделей на тестовой выборке показала модель случайного леса. Несмотря на явную тененцию к переобучению, модель работает наилучшим образом, за ней следуют с минимальным отрывом модели дерева решений и ближайших соседей, также показывающие значительно более высокие результаты на тренировочной выборке.

 5. Общий вывод:

    Для компании «Мегалайн» целесообразнее всего использовать метод случайных деревьев. С вероятностью ~ 80% он позволяет предсказать, какой тариф оптимальнее всего подходит для клиента, в зависимости от его характера потребления трафика, сообщений и звонков.

    Количество деревьев в оптимальной модели - 76, глубина каждого дерева - 12.

    Дальнейшие исследования лучше сосредоточить именно на этой модели - глубже исследовать гиперпараметры и поведение модели на новых данных. Остальные модели также не стоит отбрасывать совсем -  при увеличении количества данных метод ближайших соседей модет начать работать все лучше и лучше, так как он наиболее оптимален на больших датасетах.

    Кроме этого компании следует обратить внимание на удовлетворенность качеством обслуживания клиентов. Не исключено, что при использовании того или иного тарифа клиент может быть недоволен им и он ему может не подходить. Таким образом предсказанный оптимальный тариф может также не подходить клиенту, переходящему со старого. Собранные данные удовлетворенности клиентов позволят предсказать не оптимальный тариф, а то, насколько конкретный клиент, переходящий на него, будет доволен сменой тарифа. Так будет возможно предлагать индивидуальные услуги и скидки клиентам, что бы оптимизировать выручку безболезненно для клиента.