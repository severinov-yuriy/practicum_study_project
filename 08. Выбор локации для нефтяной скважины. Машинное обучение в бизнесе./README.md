# Восстановление золота из руды

__Необходимо подготовить прототип модели машинного обучения для компании «Цифра».__ Компания разрабатывает решения для эффективной работы промышленных предприятий.

Модель должна предсказать коэффициент восстановления золота из золотосодержащей руды. Компания предоставила данные с параметрами добычи и очистки. Модель поможет оптимизировать производство, чтобы не запускать предприятие с убыточными характеристиками.

__В рамках проекта необходимо:__

1. Подготовить данные;
2. Провести исследовательский анализ данных;
3. Построить и обучить модель.
Краткое описание процесса добычи золота из руды:
После добычи руды и обработки получается дробленая смесь. Ее отправляют на флотацию (обогащение) и двухэтапную очистку:
1. Флотация
        Во флотационную установку подаётся смесь золотосодержащей руды. После обогащения получается черновой концентрат и «отвальные хвосты», то есть остатки продукта с низкой концентрацией ценных металлов.
        На стабильность этого процесса влияет непостоянное и неоптимальное физико-химическое состояние флотационной пульпы (смеси твёрдых частиц и жидкости).


2. Очистка
        Черновой концентрат проходит две очистки. На выходе получается финальный концентрат и новые отвальные хвосты.

![](https://pictures.s3.yandex.net/resources/viruchka_1576238830.jpg)

Эффективность обогащения руды рассчитывается по следующей формуле:

![](https://pictures.s3.yandex.net/resources/Recovery_1576238822.jpg)

где:
- C — доля золота в концентрате после флотации/очистки;
- F — доля золота в сырье/концентрате до флотации/очистки;
- T — доля золота в отвальных хвостах после флотации/очистки.

Для прогноза коэффициента нужно найти долю золота в концентратах и хвостах. Причём важен не только финальный продукт, но и черновой концентрат.
Качество модели оценивается с использованием метрики __sMAPE__ (англ. Symmetric Mean Absolute Percentage Error, «симметричное среднее абсолютное процентное отклонение»).

Формула для вычисления sMAPE:
![](https://pictures.s3.yandex.net/resources/smape_1576238825.jpg)
где:
- yi – значение целевого признака для объекта с порядковым номером i в выборке, на которой измеряется качество;
- ^yi – (y с крышечкой) – значение предсказания для объекта с порядковым номером i, например, в тестовой выборке;
- N – количество объектов в выборке.

Данные находятся в трёх файлах:
- `gold_recovery_train_new.csv` — обучающая выборка;
- `gold_recovery_test_new.csv` — тестовая выборка;
- `gold_recovery_full_new.csv` — исходные данные.


Данные индексируются датой и временем получения информации (признак date). Соседние по времени параметры часто похожи.
Некоторые параметры недоступны, потому что замеряются и/или рассчитываются значительно позже. Из-за этого в тестовой выборке отсутствуют некоторые признаки, которые могут быть в обучающей. Также в тестовом наборе нет целевых признаков.
Исходный датасет содержит обучающую и тестовую выборки со всеми признаками.

Предоставленные данные являются сырыми и требуют проверки на корректность и предобработки.

__Описание данных:__

__Технологический процесс:__
- `Rougher feed` — исходное сырье;
- `Rougher additions (или reagent additions)` — флотационные реагенты: Xanthate, Sulphate, Depressant;
- `Xanthate **`— ксантогенат (промотер, или активатор флотации);
- `Sulphate` — сульфат (на данном производстве сульфид натрия);
- `Depressant` — депрессант (силикат натрия);
- `Rougher process` (англ. «грубый процесс») — флотация;
- `Rougher tails` — отвальные хвосты;
- `Float banks` — флотационная установка;
- `Cleaner process` — очистка;
- `Rougher Au` — черновой концентрат золота;
- `Final Au` — финальный концентрат золота.

__Параметры этапов:__
- `air amount` — объём воздуха;
- `fluid levels` — уровень жидкости;
- `feed size` — размер гранул сырья;
- `feed rate` — скорость подачи.

__Наименование признаков:__

1. Название признака имеет следующую структуру: `[этап].[тип_параметра].[название_параметра]`. Пример: `rougher.input.feed_ag`


1. Возможные значения для блока `[этап]`:
    - `rougher` — флотация;
    - `primary_cleaner` — первичная очистка;
    - `secondary_cleaner` — вторичная очистка;
    - `final` — финальные характеристики.
   
   
1. Возможные значения для блока `[тип_параметра]`:
    - `input` — параметры сырья;
    - `output` — параметры продукта;
    - `state` — параметры, характеризующие текущее состояние этапа;
    - `calculation` — расчётные характеристики.
    
Необходимо построить прогноз для двух величин:
1. Эффективность обогащения чернового концентрата `rougher.output.recovery`.
2. Эффективность обогащения финального концентрата `final.output.recovery`.

Итоговая метрика складывается из значений метрики sMAPE для каждой из этих величин в соотношении, взвешенно, с весами 0.25 для эффективности обогащения чернового концентрата и 0.75 для эффективности обогащения финального концентрата.

